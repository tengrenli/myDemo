{"version":3,"file":"vue.js","sources":["../../src/utils.js","../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["export function isFunction (value) {\n  return typeof value === 'function'\n}\nexport function isObject (value) {\n  return value !== null && typeof value === 'object'\n}\n","let oldArrayPrototype = Array.prototype\nexport let arrayMethods = Object.create(oldArrayPrototype)\n\nlet methods = ['push', 'shift', 'unshift', 'pop', 'reverse', 'sort', 'splice']\n\nmethods.forEach(method => {\n  arrayMethods[method] = function (...args) {\n    oldArrayPrototype[method].call(this, ...args)\n    let ob = this.__ob__\n    let newInserted\n    switch (method) {\n      case 'push':\n      case 'unshift':\n        newInserted = args\n        break\n      case 'splice':\n        newInserted = args.slice(2)\n      default:\n        break\n    }\n\n    if (newInserted) {\n      ob.observeArray(newInserted)\n    }\n  }\n})\n","import { isObject } from '../utils'\nimport { arrayMethods } from './array'\nclass Observer {\n  constructor (data) {\n    Object.defineProperty(data, '__ob__', {\n      value: this,\n      enumerable: false\n    })\n\n    // 数组不对索引进行监测\n    if (Array.isArray(data)) {\n      data.__proto__ = arrayMethods\n      this.observeArray(data)\n    } else {\n      this.walk(data)\n    }\n  }\n\n  observeArray (data) {\n    data.forEach(item => observe(item))\n  }\n\n  walk (data) {\n    Object.keys(data).forEach(key => {\n      defineReactive(data, key, data[key])\n    })\n  }\n}\nfunction defineReactive (data, key, value) {\n  observe(value)\n  Object.defineProperty(data, key, {\n    get () {\n      console.log('get')\n      return value\n    },\n    set (newValue) {\n      if (newValue === value) {\n        return\n      }\n      observe(newValue)\n      console.log('set')\n      value = newValue\n    }\n  })\n}\nexport function observe (data) {\n  if (!isObject(data)) {\n    return\n  }\n  if (data.__ob__) {\n    return\n  }\n  new Observer(data)\n}\n","import { observe } from './observer/index'\nimport { isFunction } from './utils'\nexport function initState (vm) {\n  const opts = vm.$options\n  if (opts.data) {\n    initData(vm)\n  }\n}\n\nfunction initData (vm) {\n  let data = vm.$options.data\n  data = vm._data = isFunction(data) ? data.call(vm) : data\n  observe(data)\n  console.log(vm)\n}\n","import { initState } from './state'\nexport function initMixin (Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this\n    vm.$options = options\n\n    initState(vm)\n  }\n}","import { initMixin } from \"./init\"\n\nfunction Vue (options) {\n  this._init(options)\n}\ninitMixin(Vue)\nexport default Vue\n"],"names":["isFunction","value","isObject","oldArrayPrototype","Array","prototype","arrayMethods","Object","create","methods","forEach","method","args","call","ob","__ob__","newInserted","slice","observeArray","Observer","data","defineProperty","enumerable","isArray","__proto__","walk","item","observe","keys","key","defineReactive","get","console","log","set","newValue","initState","vm","opts","$options","initData","_data","initMixin","Vue","_init","options"],"mappings":"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"}