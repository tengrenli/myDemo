{"version":3,"file":"vue.js","sources":["../../src/utils.js","../../src/observer/dep.js","../../src/observer/index.js","../../src/state.js","../../src/vdom/patch.js","../../src/observer/watcher.js","../../src/lifecycle.js","../../src/compiler/parser.js","../../src/compiler/generate.js","../../src/compiler/index.js","../../src/init.js","../../src/vdom/index.js","../../src/render.js","../../src/index.js"],"sourcesContent":["export function isFunction (value) {\n  return typeof value === 'function'\n}\n\nexport function isObject (value) {\n  return value !== null && typeof value === 'object'\n}\n","let id = 0\n// 依赖收集\nclass Dep {\n  constructor() {\n    this.id = id++\n    this.subs = []\n  }\n  \n  \n  depend () {\n    if (Dep.target) {\n      this.subs.push(Dep.target)\n    }\n  }\n  \n  notify () {\n    this.subs.forEach(watcher => {\n      watcher.update()\n    })\n  }\n}\n\nexport function pushTarget (watcher) {\n  Dep.target = watcher\n}\n\nexport function popTarget () {\n  Dep.target = null\n}\n \n\nexport default Dep","import { isObject } from '../utils'\nimport Dep from './dep'\n\nclass Observer {\n  constructor (data) {\n    Object.defineProperty(data, '__ob__', {\n      value: this,\n      enumerable: false\n    })\n\n    if (Array.isArray(data)) {\n      this.observeArray(data)\n    } else {\n      this.walk(data)\n    }\n  }\n  observeArray (data) {\n    data.forEach(item => observe())\n  }\n  walk (data) {\n    Object.keys(data).forEach(key => {\n      defineReactive(data, key, data[key])\n    })\n  }\n}\n\nfunction defineReactive (data, key, value) {\n  observe(value)\n  const dep = new Dep()\n  Object.defineProperty(data, key, {\n    get () {\n      if (Dep.target) {\n        dep.depend()\n      }\n      return value\n    },\n    set (newVal) {\n      if (value === newVal) {\n        return\n      }\n      console.log('update')\n      value = newVal\n      dep.notify()\n    }\n  })\n}\n\nexport function observe (data) {\n  if (!isObject(data)) {\n    return\n  }\n\n  if (data.__ob__) {\n    return\n  }\n  return new Observer(data)\n}\n","import { observe } from './observer/index'\nimport { isFunction } from './utils'\nexport function initState (vm) {\n  let opts = vm.$options\n  if (opts.data) {\n    initData(vm)\n  }\n}\nfunction proxy (vm, source, key) {\n  Object.defineProperty(vm, key, {\n    get () {\n      return vm[source][key]\n    },\n    set (newValue) {\n      vm[source][key] = newValue\n    }\n  })\n}\nfunction initData (vm) {\n  let data = vm.$options.data\n\n  data = vm._data = isFunction(data) ? data.call(vm) : data\n\n  for (let key in data) {\n    proxy(vm, '_data', key)\n  }\n  observe(data)\n}\n","export function patch(oldVnode, vnode) {\n    if (oldVnode.nodeType == 1) {\n        // 用vnode  来生成真实dom 替换原本的dom元素\n        const parentElm = oldVnode.parentNode; // 找到他的父亲\n        let elm = createElm(vnode); //根据虚拟节点 创建元素\n        parentElm.insertBefore(elm, oldVnode.nextSibling);\n\n        parentElm.removeChild(oldVnode);\n        return elm\n    }\n}\n\nfunction createElm(vnode) {\n    let { tag, data, children, text, vm } = vnode\n    if (typeof tag === 'string') { // 元素\n        vnode.el = document.createElement(tag); // 虚拟节点会有一个el属性 对应真实节点\n        children.forEach(child => {\n            vnode.el.appendChild(createElm(child))\n        });\n    } else {\n        vnode.el = document.createTextNode(text);\n    }\n    return vnode.el\n}","let id = 0\nimport { pushTarget, popTarget } from './dep'\nclass Watcher {\n  constructor (vm, exprOrFn, cb, options) {\n    this.vm = vm\n    this.exprOrFn = exprOrFn\n    this.cb = cb\n    this.options = options\n    this.id = id++\n\n    this.getter = exprOrFn\n\n    this.get()\n  }\n\n  get () {\n    pushTarget(this)\n    this.getter()\n    popTarget()\n  }\n\n  update () {\n    console.log('update')\n    this.get()\n  }\n}\n\nexport default Watcher\n","import { patch } from './vdom/patch'\nimport Watcher from './observer/watcher'\nexport function mountComponent (vm, el) {\n  let updateComponent = () => {\n    vm._update(vm._render())\n  }\n\n  // updateComponent()\n  new Watcher(vm, updateComponent, () => {}, true)\n}\n\nexport function lifecycleMixin (Vue) {\n  Vue.prototype._update = function (vnode) {\n    console.log('vnode', vnode)\n    // 既有初始化 又又更新\n    const vm = this\n\n    vm.$el = patch(vm.$el, vnode)\n  }\n}\n","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`\n// 标签名\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`\n//  用来获取的标签名的 match后的索引为1的\nconst startTagOpen = new RegExp(`^<${qnameCapture}`)\n// 匹配开始标签的\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`)\n// 匹配闭合标签的\n//           aa  =   \"  xxx \"  | '  xxxx '  | xxx\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\n// a=b  a=\"b\"  a='b'\nconst startTagClose = /^\\s*(\\/?)>/\n//     />   <div/>\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\n// {{aaaaa}}\n\nfunction createAstElement (tagName, attrs) {\n  return {\n    tag: tagName,\n    type: 1,\n    children: [],\n    parent: null,\n    attrs\n  }\n}\nlet root = null\nlet stack = []\nfunction start (tagName, attributes) {\n  let parent = stack[stack.length - 1]\n  let element = createAstElement(tagName, attributes)\n  if (!root) {\n    root = element\n  }\n  if (parent) {\n    element.parent = parent // 当放入栈中时 继续父亲是谁\n    parent.children.push(element)\n  }\n  stack.push(element)\n}\nfunction end (tagName) {\n  let last = stack.pop()\n  if (last.tag !== tagName) {\n    throw new Error('标签有误')\n  }\n}\nfunction chars (text) {\n  text = text.replace(/\\s/g, '')\n  let parent = stack[stack.length - 1]\n  if (text) {\n    parent.children.push({\n      type: 3,\n      text\n    })\n  }\n}\n\nexport function parserHTML (html) {\n  function advance (len) {\n    html = html.substring(len)\n  }\n\n  function parseStartTag () {\n    const start = html.match(startTagOpen)\n    if (start) {\n      const match = {\n        tagName: start[1],\n        attrs: []\n      }\n      advance(start[0].length)\n      let end\n      // 如果没有遇到标签结尾就不停的解析\n      let attr\n\n      while (\n        !(end = html.match(startTagClose)) &&\n        (attr = html.match(attribute))\n      ) {\n        match.attrs.push({\n          name: attr[1],\n          value: attr[3] || attr[4] || attr[5]\n        })\n        advance(attr[0].length)\n      }\n      if (end) {\n        advance(end[0].length)\n      }\n      return match\n    }\n    return false // 不是开始标签\n  }\n  while (html) {\n    // 看要解析的内容是否存在，如果存在就不停的解析\n    let textEnd = html.indexOf('<') // 当前解析的开头\n    if (textEnd == 0) {\n      const startTagMatch = parseStartTag(html) // 解析开始标签\n      if (startTagMatch) {\n        start(startTagMatch.tagName, startTagMatch.attrs)\n        continue\n      }\n      const endTagMatch = html.match(endTag)\n      if (endTagMatch) {\n        end(endTagMatch[1])\n        advance(endTagMatch[0].length)\n        continue\n      }\n    }\n    let text // //  </div>\n    if (textEnd > 0) {\n      text = html.substring(0, textEnd)\n    }\n    if (text) {\n      chars(text)\n      advance(text.length)\n    }\n  }\n\n  return root\n}\n","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\n// {{aaaaa}}\n\n// html字符串 =》 字符串  _c('div',{id:'app',a:1},'hello')\n\nfunction genProps (attrs) {\n  // [{name:'xxx',value:'xxx'},{name:'xxx',value:'xxx'}]\n  let str = ''\n  for (let i = 0; i < attrs.length; i++) {\n    let attr = attrs[i]\n    if (attr.name === 'style') {\n      // color:red;background:blue\n      let styleObj = {}\n      attr.value.replace(/([^;:]+)\\:([^;:]+)/g, function () {\n        styleObj[arguments[1]] = arguments[2]\n      })\n      attr.value = styleObj\n    }\n    str += `${attr.name}:${JSON.stringify(attr.value)},`\n  }\n  return `{${str.slice(0, -1)}}`\n}\n\nfunction gen (el) {\n  if (el.type == 1) {\n    // element = 1 text = 3\n    return generate(el)\n  } else {\n    let text = el.text\n    if (!defaultTagRE.test(text)) {\n      return `_v('${text}')`\n    } else {\n      // 'hello' + arr + 'world'    hello {{arr}} {{aa}} world\n      let tokens = []\n      let match\n      let lastIndex = (defaultTagRE.lastIndex = 0) // CSS-LOADER 原理一样\n      while ((match = defaultTagRE.exec(text))) {\n        // 看有没有匹配到\n        let index = match.index // 开始索引\n        if (index > lastIndex) {\n          tokens.push(JSON.stringify(text.slice(lastIndex, index)))\n        }\n        tokens.push(`_s(${match[1].trim()})`) // JSON.stringify()\n        lastIndex = index + match[0].length\n      }\n      if (lastIndex < text.length) {\n        tokens.push(JSON.stringify(text.slice(lastIndex)))\n      }\n      return `_v(${tokens.join('+')})`\n    }\n  }\n}\n\nfunction genChildren (el) {\n  let children = el.children // 获取儿子\n  if (children) {\n    return children.map(c => gen(c)).join(',')\n  }\n  return false\n}\n\nexport function generate (el) {\n  //  _c('div',{id:'app',a:1},_c('span',{},'world'),_v())\n  // 遍历树 将树拼接成字符串\n  let children = genChildren(el)\n  let code = `_c('${el.tag}',${\n    el.attrs.length ? genProps(el.attrs) : 'undefined'\n  }${children ? `,${children}` : ''})`\n\n  return code\n}\n","import { parserHTML } from './parser'\nimport { generate } from './generate'\nexport function compileToFunction (template) {\n  let root = parserHTML(template)\n  let code = generate(root)\n  let render = new Function(`with(this){return ${code}}`) // code 中会用到数据 数据在vm上\n\n  return render\n}\n","import { initState } from './state'\nimport { mountComponent } from './lifecycle'\nimport { compileToFunction } from './compiler/index'\nexport function initMixin (Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this\n    vm.$options = options || {}\n\n    initState(vm)\n\n    if (vm.$options.el) {\n      vm.$mount(vm.$options.el)\n    }\n  }\n\n  Vue.prototype.$mount = function (el) {\n    const vm = this\n    const options = vm.$options\n    el = document.querySelector(el)\n    vm.$el = el\n    // 无render 方法生成   解析模板\n    if (!options.render && el) {\n      let template = options.template\n      if (!template && el) {\n        template = el.outerHTML\n        let render = compileToFunction(template)\n        options.render = render\n       }\n    }\n\n    mountComponent(vm, el)\n  }\n}\n","export function createElement(vm, tag, data = {}, ...children) {\n    return vnode(vm, tag, data, data.key, children, undefined);\n}\n\nexport function createTextElement(vm, text) {\n    return vnode(vm, undefined, undefined, undefined, undefined, text);\n}\n\nfunction vnode(vm, tag, data, key, children, text) {\n    return {\n        vm,\n        tag,\n        data,\n        key,\n        children,\n        text,\n        // .....\n    }\n}","import { createElement, createTextElement } from './vdom/index'\nexport function renderMixin (Vue) {\n  Vue.prototype._c = function () {\n    // createElement\n    return createElement(this, ...arguments)\n  }\n  Vue.prototype._v = function (text) {\n    // createTextElement\n    return createTextElement(this, text)\n  }\n  Vue.prototype._s = function (val) {\n    // stringify\n    if (typeof val == 'object') return JSON.stringify(val)\n    return val\n  }\n  Vue.prototype._render = function () {\n    const vm = this\n    let render = vm.$options.render // 就是我们解析出来的render方法，同时也有可能是用户写的\n    let vnode = render.call(vm)\n    return vnode\n  }\n}\n","import { initMixin } from './init'\nimport { renderMixin } from './render'\nimport { lifecycleMixin } from './lifecycle'\nfunction Vue (options) {\n  this._init(options)\n}\n\ninitMixin(Vue)\nrenderMixin(Vue)\nlifecycleMixin(Vue)\nexport default Vue\n"],"names":["isFunction","value","isObject","id","Dep","subs","target","push","forEach","watcher","update","pushTarget","popTarget","Observer","data","Object","defineProperty","enumerable","Array","isArray","observeArray","walk","item","observe","keys","key","defineReactive","dep","get","depend","set","newVal","console","log","notify","__ob__","initState","vm","opts","$options","initData","proxy","source","newValue","_data","call","patch","oldVnode","vnode","nodeType","parentElm","parentNode","elm","createElm","insertBefore","nextSibling","removeChild","tag","children","text","el","document","createElement","child","appendChild","createTextNode","Watcher","exprOrFn","cb","options","getter","mountComponent","updateComponent","_update","_render","lifecycleMixin","Vue","prototype","$el","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","createAstElement","tagName","attrs","type","parent","root","stack","start","attributes","length","element","end","last","pop","Error","chars","replace","parserHTML","html","advance","len","substring","parseStartTag","match","attr","name","textEnd","indexOf","startTagMatch","endTagMatch","defaultTagRE","genProps","str","i","styleObj","arguments","JSON","stringify","slice","gen","generate","test","tokens","lastIndex","exec","index","trim","join","genChildren","map","c","code","compileToFunction","template","render","Function","initMixin","_init","$mount","querySelector","outerHTML","undefined","createTextElement","renderMixin","_c","_v","_s","val"],"mappings":"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"}