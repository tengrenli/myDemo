{"version":3,"file":"runtime-dom.esm-bundler.js","sources":["../../shared/src/index.ts","../../runtime-core/src/vnode.ts","../../runtime-core/src/apiCreateApp.ts","../../runtime-core/src/renderer.ts","../src/nodeOps.ts","../src/modules/attr.ts","../src/modules/class.ts","../src/modules/events.ts","../src/modules/style.ts","../src/patchProp.ts","../src/index.ts"],"sourcesContent":["export const isObject = value => typeof value == 'object' && value !== null\nexport const extend = Object.assign\nexport const isArray = Array.isArray\nexport const isFunction = value => typeof value == 'function'\nexport const isNumber = value => typeof value == 'number'\nexport const isString = value => typeof value === 'string'\nexport const isIntegerKey = key => parseInt(key) + '' === key\n\nlet hasOwnpRroperty = Object.prototype.hasOwnProperty\nexport const hasOwn = (target, key) => hasOwnpRroperty.call(target, key)\n\nexport const hasChanged = (oldValue, value) => oldValue !== value\nexport * from './shapeFlags'\n","import { isArray, isObject, isString, ShapeFlags } from '@vue/shared/src'\nexport const createVNode = (type, props, children = null) => {\n  const shapeFlag = isString(type)\n    ? ShapeFlags.ELEMENT\n    : isObject(type)\n    ? ShapeFlags.STATEFUL_COMPONENT\n    : 0\n  const vnode = {\n    type,\n    props,\n    children,\n    key: props && props.key, // 用于diff算法\n    el: null, // 虚拟节点对应的真实节点\n    shapeFlag // 自己是什么类型\n  }\n  normalizeChildren(vnode, children) // 根据子节点计算孩子类型\n  return vnode\n}\nfunction normalizeChildren (vnode, children) {\n  let type = 0\n  if (children == null) {\n  } else if (isArray(children)) {\n    type = ShapeFlags.ARRAY_CHILDREN // 数组\n  } else {\n    type = ShapeFlags.TEXT_CHILDREN // 文本\n  }\n  vnode.shapeFlag |= type\n}\n","import { createVNode } from \"./vnode\"\n\nexport function createAppAPI (render) {\n  return function createApp (rootComponent, rootProps) {\n    const app = {\n      _props: rootProps,\n      _component: rootComponent,\n      _container: null,\n      mount(rootContainer)\n      {\n        const vnode = createVNode(rootComponent, rootProps)\n        console.log('vnode', vnode)\n        render(vnode, rootContainer)\n        app._container = rootContainer\n      }\n    }\n    return app\n  }\n}\n","import { createAppAPI } from './apiCreateApp'\n\nexport const createRender = renderOptions => {\n  const render = (vnode, container) => {\n    console.log(vnode, container)\n  }\n  return {\n    createApp: createAppAPI(render)\n  }\n}\n","export const nodeOps = {\n  createElement: tagName => document.createElement(tagName),\n  remove: child => {\n    const parent = child.parentNode\n    if (parent) {\n      parent.removeChild(child)\n    }\n  },\n  insert: (child, parent, anchor = null) => {\n    parent.insertBefore(child, anchor)\n  },\n  querySelector: selector => document.querySelector(selector),\n  setElementText: (el, text) => (el.textContent = text),\n  createText: text => document.createTextNode(text),\n  setText: (node, text) => (node.nodeValue = text)\n}\n","export const patchAttr = (el, key, value) => {\n  if (value === null) {\n    el.removeAttribute(key)\n  } else {\n    el.setAttribute(key, value)\n  }\n}\n","export const patchClass = (el, value) => {\n  if (value == null) {\n    value = ''\n  }\n  el.className = value\n}\n","export const patchEvents = (el, key, value) => {\n  const invokes = el._vei || (el._vei = {})\n  const exists = invokes[key] // 拿老事件\n  if (value && exists) {\n  } else {\n    const eventName = key.slice(2).toLowerCase()\n    if (value) {\n      let invoker = (invokes[key] = createInvoker(value))\n      el.addEventListener(eventName, invoker)\n    } else {\n      el.removeEventListener(eventName, exists)\n      invokes[key] = undefined\n    }\n  }\n}\n\nfunction createInvoker (value) {\n  const invoker = e => {\n    invoker.value(e)\n  }\n  invoker.value = value\n  return invoker\n}\n","export const patchStyle = (el, prev, next) => {\n  const style = el.style // 获取样式\n  if (next == null) {\n    el.removeAttribute('style')\n  } else {\n    if (prev) {\n      for (let key in prev) {\n        if (!next[key]) {\n          style[key] = ''\n        }\n      }\n    }\n    for (let key in next) {\n      style[key] = next[key]\n    }\n  }\n}\n","import { patchAttr } from './modules/attr'\nimport { patchClass } from './modules/class'\nimport { patchEvents } from './modules/events'\nimport { patchStyle } from './modules/style'\n\nexport const patchProp = (el, key, prevValue, nextValue) => {\n  switch (key) {\n    case 'class':\n      patchClass(el, nextValue)\n      break\n    case 'style':\n      patchStyle(el, prevValue, nextValue)\n      break\n    default:\n      if (/^on[^A-Z]/.test(key)) {\n        patchEvents(el, key, nextValue)\n      } else {\n        patchAttr(el, key, nextValue)\n      }\n  }\n}\n","import { createRender } from '@vue/runtime-core'\nimport { extend } from '@vue/shared'\nimport { nodeOps } from './nodeOps'\nimport { patchProp } from './patchProp'\n\nconst renderOptions = extend({ patchProp }, nodeOps)\n\nexport const createApp = (rootComponent, rootProps = null) => {\n  console.log(rootComponent, rootProps)\n  const app = createRender(renderOptions).createApp(rootComponent, rootProps)\n  const { mount } = app\n  app.mount = function (container) {\n    mount(container)\n    container = document.querySelector(container)\n    container.innerHTML = ''\n  }\n\n  return app\n}\n"],"names":[],"mappings":"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"}