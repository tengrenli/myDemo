{"version":3,"file":"runtime-dom.global.js","sources":["../../shared/src/index.ts","../../runtime-core/src/vnode.ts","../../runtime-core/src/apiCreateApp.ts","../../runtime-core/src/renderer.ts","../src/nodeOps.ts","../src/modules/attr.ts","../src/modules/class.ts","../src/modules/events.ts","../src/modules/style.ts","../src/patchProp.ts","../src/index.ts"],"sourcesContent":["export const isObject = value => typeof value == 'object' && value !== null\nexport const extend = Object.assign\nexport const isArray = Array.isArray\nexport const isFunction = value => typeof value == 'function'\nexport const isNumber = value => typeof value == 'number'\nexport const isString = value => typeof value === 'string'\nexport const isIntegerKey = key => parseInt(key) + '' === key\n\nlet hasOwnpRroperty = Object.prototype.hasOwnProperty\nexport const hasOwn = (target, key) => hasOwnpRroperty.call(target, key)\n\nexport const hasChanged = (oldValue, value) => oldValue !== value\nexport * from './shapeFlags'\n","import { isArray, isObject, isString, ShapeFlags } from '@vue/shared/src'\nexport const createVNode = (type, props, children = null) => {\n  const shapeFlag = isString(type)\n    ? ShapeFlags.ELEMENT\n    : isObject(type)\n    ? ShapeFlags.STATEFUL_COMPONENT\n    : 0\n  const vnode = {\n    type,\n    props,\n    children,\n    key: props && props.key, // 用于diff算法\n    el: null, // 虚拟节点对应的真实节点\n    shapeFlag // 自己是什么类型\n  }\n  normalizeChildren(vnode, children) // 根据子节点计算孩子类型\n  return vnode\n}\nfunction normalizeChildren (vnode, children) {\n  let type = 0\n  if (children == null) {\n  } else if (isArray(children)) {\n    type = ShapeFlags.ARRAY_CHILDREN // 数组\n  } else {\n    type = ShapeFlags.TEXT_CHILDREN // 文本\n  }\n  vnode.shapeFlag |= type\n}\n","import { createVNode } from \"./vnode\"\n\nexport function createAppAPI (render) {\n  return function createApp (rootComponent, rootProps) {\n    const app = {\n      _props: rootProps,\n      _component: rootComponent,\n      _container: null,\n      mount(rootContainer)\n      {\n        const vnode = createVNode(rootComponent, rootProps)\n        console.log('vnode', vnode)\n        render(vnode, rootContainer)\n        app._container = rootContainer\n      }\n    }\n    return app\n  }\n}\n","import { createAppAPI } from './apiCreateApp'\n\nexport const createRender = renderOptions => {\n  const render = (vnode, container) => {\n    console.log(vnode, container)\n  }\n  return {\n    createApp: createAppAPI(render)\n  }\n}\n","export const nodeOps = {\n  createElement: tagName => document.createElement(tagName),\n  remove: child => {\n    const parent = child.parentNode\n    if (parent) {\n      parent.removeChild(child)\n    }\n  },\n  insert: (child, parent, anchor = null) => {\n    parent.insertBefore(child, anchor)\n  },\n  querySelector: selector => document.querySelector(selector),\n  setElementText: (el, text) => (el.textContent = text),\n  createText: text => document.createTextNode(text),\n  setText: (node, text) => (node.nodeValue = text)\n}\n","export const patchAttr = (el, key, value) => {\n  if (value === null) {\n    el.removeAttribute(key)\n  } else {\n    el.setAttribute(key, value)\n  }\n}\n","export const patchClass = (el, value) => {\n  if (value == null) {\n    value = ''\n  }\n  el.className = value\n}\n","export const patchEvents = (el, key, value) => {\n  const invokes = el._vei || (el._vei = {})\n  const exists = invokes[key] // 拿老事件\n  if (value && exists) {\n  } else {\n    const eventName = key.slice(2).toLowerCase()\n    if (value) {\n      let invoker = (invokes[key] = createInvoker(value))\n      el.addEventListener(eventName, invoker)\n    } else {\n      el.removeEventListener(eventName, exists)\n      invokes[key] = undefined\n    }\n  }\n}\n\nfunction createInvoker (value) {\n  const invoker = e => {\n    invoker.value(e)\n  }\n  invoker.value = value\n  return invoker\n}\n","export const patchStyle = (el, prev, next) => {\n  const style = el.style // 获取样式\n  if (next == null) {\n    el.removeAttribute('style')\n  } else {\n    if (prev) {\n      for (let key in prev) {\n        if (!next[key]) {\n          style[key] = ''\n        }\n      }\n    }\n    for (let key in next) {\n      style[key] = next[key]\n    }\n  }\n}\n","import { patchAttr } from './modules/attr'\nimport { patchClass } from './modules/class'\nimport { patchEvents } from './modules/events'\nimport { patchStyle } from './modules/style'\n\nexport const patchProp = (el, key, prevValue, nextValue) => {\n  switch (key) {\n    case 'class':\n      patchClass(el, nextValue)\n      break\n    case 'style':\n      patchStyle(el, prevValue, nextValue)\n      break\n    default:\n      if (/^on[^A-Z]/.test(key)) {\n        patchEvents(el, key, nextValue)\n      } else {\n        patchAttr(el, key, nextValue)\n      }\n  }\n}\n","import { createRender } from '@vue/runtime-core'\nimport { extend } from '@vue/shared'\nimport { nodeOps } from './nodeOps'\nimport { patchProp } from './patchProp'\n\nconst renderOptions = extend({ patchProp }, nodeOps)\n\nexport const createApp = (rootComponent, rootProps = null) => {\n  console.log(rootComponent, rootProps)\n  const app = createRender(renderOptions).createApp(rootComponent, rootProps)\n  const { mount } = app\n  app.mount = function (container) {\n    mount(container)\n    container = document.querySelector(container)\n    container.innerHTML = ''\n  }\n\n  return app\n}\n"],"names":[],"mappings":"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"}